---
import siteDetails from '@/config/siteDetails';
import Navbar from '@/components/Navbar.astro';
import Footer from '@/components/Footer.astro';
import BackToTop from '@/components/BackToTop.astro';
import Breadcrumb from '@/components/Breadcrumb.astro';
import PageLoadingOverlay from '@/components/PageLoadingOverlay.astro';

interface Props {
  title?: string;
  description?: string;
  pageType?: 'general' | 'catholic' | 'veteran';
  language?: 'en' | 'es';
}

const { title, description, pageType, language } = Astro.props;

// Detect language and page type from URL if not provided
const pathname = Astro.url.pathname;
const detectedLanguage: 'en' | 'es' = language || (pathname.includes('-es') || pathname === '/es' ? 'es' : 'en');
const detectedPageType: 'general' | 'catholic' | 'veteran' = pageType || 
  (pathname.includes('catholic') ? 'catholic' : 
   pathname.includes('veteran') ? 'veteran' : 'general');

const pageTitle = title 
  ? `${title} | ${siteDetails.companyName}` 
  : siteDetails.companyName;
const pageDescription = description || `Professional funeral and cremation services with dignity, respect, and understanding.`;

// Generate hreflang alternates
function getAlternateUrls(): Array<{ lang: string; url: string }> {
  const baseUrl = Astro.site?.href || Astro.url.origin;
  const alternates: Array<{ lang: string; url: string }> = [];
  
  // Current page
  alternates.push({ lang: detectedLanguage, url: `${baseUrl}${pathname}` });
  
  // Route mapping for language alternates
  const routeMap: Record<string, { en: string; es: string }> = {
    '/': { en: '/', es: '/es' },
    '/es': { en: '/', es: '/es' },
    '/catholic': { en: '/catholic', es: '/catholic-es' },
    '/catholic-es': { en: '/catholic', es: '/catholic-es' },
    '/veteran': { en: '/veteran', es: '/veteran-es' },
    '/veteran-es': { en: '/veteran', es: '/veteran-es' },
    '/cremation': { en: '/cremation', es: '/cremation-es' },
    '/cremation-es': { en: '/cremation', es: '/cremation-es' },
    '/burial': { en: '/burial', es: '/burial-es' },
    '/burial-es': { en: '/burial', es: '/burial-es' },
    '/catholic-cremation': { en: '/catholic-cremation', es: '/catholic-cremation-es' },
    '/catholic-cremation-es': { en: '/catholic-cremation', es: '/catholic-cremation-es' },
    '/catholic-burial': { en: '/catholic-burial', es: '/catholic-burial-es' },
    '/catholic-burial-es': { en: '/catholic-burial', es: '/catholic-burial-es' },
    '/veteran-cremation': { en: '/veteran-cremation', es: '/veteran-cremation-es' },
    '/veteran-cremation-es': { en: '/veteran-cremation', es: '/veteran-cremation-es' },
    '/veteran-burial': { en: '/veteran-burial', es: '/veteran-burial-es' },
    '/veteran-burial-es': { en: '/veteran-burial', es: '/veteran-burial-es' },
  };
  
  // Get alternate language version
  if (routeMap[pathname]) {
    const alternatePath = detectedLanguage === 'en' 
      ? routeMap[pathname].es 
      : routeMap[pathname].en;
    alternates.push({ 
      lang: detectedLanguage === 'en' ? 'es' : 'en', 
      url: `${baseUrl}${alternatePath}` 
    });
  } else {
    // Fallback: try to convert by adding/removing -es suffix
    if (detectedLanguage === 'en') {
      // English -> Spanish
      const esPath = pathname.endsWith('-es') ? pathname : `${pathname}-es`;
      alternates.push({ lang: 'es', url: `${baseUrl}${esPath}` });
    } else {
      // Spanish -> English
      const enPath = pathname.endsWith('-es') ? pathname.replace(/-es$/, '') : pathname;
      alternates.push({ lang: 'en', url: `${baseUrl}${enPath}` });
    }
  }
  
  return alternates;
}

const alternateUrls = getAlternateUrls();

// Generate breadcrumb items based on current path
function generateBreadcrumbs(): Array<{ label: string; href: string }> {
  const items: Array<{ label: string; href: string }> = [];
  
  // Always start with Home
  items.push({
    label: detectedLanguage === 'es' ? 'Inicio' : 'Home',
    href: detectedLanguage === 'es' ? '/es' : '/'
  });
  
  // Don't show breadcrumb for home page (component will handle this)
  if (pathname === '/' || pathname === '/es') {
    return items;
  }
  
  // Language labels
  const labels: Record<string, { en: string; es: string }> = {
    'catholic': { en: 'Catholic', es: 'Católico' },
    'veteran': { en: 'Veteran', es: 'Veterano' },
    'cremation': { en: 'Cremation', es: 'Cremación' },
    'burial': { en: 'Burial', es: 'Entierro' },
    'accessibility': { en: 'Accessibility', es: 'Accesibilidad' },
    'privacy-policy': { en: 'Privacy Policy', es: 'Política de Privacidad' },
    'traditional-services': { en: 'Traditional Services', es: 'Servicios Tradicionales' },
    'pre-planning': { en: 'Pre-Planning', es: 'Planificación Previa' },
    'immediate-need': { en: 'Immediate Need', es: 'Necesidad Inmediata' },
  };
  
  // Handle landing pages (catholic, veteran)
  if (pathname === '/catholic' || pathname === '/catholic-es') {
    items.push({
      label: labels['catholic'][detectedLanguage],
      href: pathname
    });
    return items;
  }
  
  if (pathname === '/veteran' || pathname === '/veteran-es') {
    items.push({
      label: labels['veteran'][detectedLanguage],
      href: pathname
    });
    return items;
  }
  
  // Handle service pages
  // Check if it's a catholic page
  if (pathname.includes('catholic-')) {
    // Add Catholic breadcrumb
    const catholicPath = detectedLanguage === 'es' ? '/catholic-es' : '/catholic';
    items.push({
      label: labels['catholic'][detectedLanguage],
      href: catholicPath
    });
    
    // Add service type
    if (pathname.includes('cremation')) {
      const servicePath = detectedLanguage === 'es' ? '/catholic-cremation-es' : '/catholic-cremation';
      items.push({
        label: labels['cremation'][detectedLanguage],
        href: servicePath
      });
    } else if (pathname.includes('burial')) {
      const servicePath = detectedLanguage === 'es' ? '/catholic-burial-es' : '/catholic-burial';
      items.push({
        label: labels['burial'][detectedLanguage],
        href: servicePath
      });
    }
  }
  // Check if it's a veteran page
  else if (pathname.includes('veteran-')) {
    // Add Veteran breadcrumb
    const veteranPath = detectedLanguage === 'es' ? '/veteran-es' : '/veteran';
    items.push({
      label: labels['veteran'][detectedLanguage],
      href: veteranPath
    });
    
    // Add service type
    if (pathname.includes('cremation')) {
      const servicePath = detectedLanguage === 'es' ? '/veteran-cremation-es' : '/veteran-cremation';
      items.push({
        label: labels['cremation'][detectedLanguage],
        href: servicePath
      });
    } else if (pathname.includes('burial')) {
      const servicePath = detectedLanguage === 'es' ? '/veteran-burial-es' : '/veteran-burial';
      items.push({
        label: labels['burial'][detectedLanguage],
        href: servicePath
      });
    }
  }
  // General service pages (cremation, burial)
  else if (pathname.includes('cremation') || pathname.includes('burial')) {
    if (pathname.includes('cremation')) {
      const servicePath = detectedLanguage === 'es' ? '/cremation-es' : '/cremation';
      items.push({
        label: labels['cremation'][detectedLanguage],
        href: servicePath
      });
    } else if (pathname.includes('burial')) {
      const servicePath = detectedLanguage === 'es' ? '/burial-es' : '/burial';
      items.push({
        label: labels['burial'][detectedLanguage],
        href: servicePath
      });
    }
  }
  // Handle other pages (accessibility, privacy-policy, etc.)
  else {
    const pageName = pathname.replace(/^\/|\/$/g, '').replace(/-es$/, '');
    if (labels[pageName]) {
      items.push({
        label: labels[pageName][detectedLanguage],
        href: pathname
      });
    }
  }
  
  return items;
}

const breadcrumbItems = generateBreadcrumbs();

// Determine favicon paths based on page type
const faviconConfig = detectedPageType === 'veteran' 
  ? {
      standard: '/favicon-veteran.webp',
      highDpi: '/favicon-veteran-high-dpi.webp',
      appleTouch: '/favicon-veteran-apple-touch.webp',
    }
  : {
      standard: '/favicon.webp',
      highDpi: '/favicon-high-dpi.webp',
      appleTouch: '/favicon-apple-touch.webp',
    };

// Generate base structured data (Schema.org JSON-LD)
function generateBaseSchema() {
  const baseUrl = Astro.site?.href || Astro.url.origin;
  const imageUrl = new URL('/images/hero.webp', baseUrl).href;
  
  // Build address object only if address fields are available
  const address: any = {};
  if (siteDetails.address.street || siteDetails.address.city) {
    address['@type'] = 'PostalAddress';
    if (siteDetails.address.street) address.streetAddress = siteDetails.address.street;
    if (siteDetails.address.city) address.addressLocality = siteDetails.address.city;
    if (siteDetails.address.state) address.addressRegion = siteDetails.address.state;
    if (siteDetails.address.zip) address.postalCode = siteDetails.address.zip;
  }
  
  // Use actual phone from siteDetails, fallback to the one in the plan
  const phone = siteDetails.phone && siteDetails.phone !== '(111) 111-1111' 
    ? siteDetails.phone 
    : '(111) 111-1111';
  
  const schema: any = {
    '@context': 'https://schema.org',
    '@type': 'FuneralHome',
    name: siteDetails.companyName,
    image: imageUrl,
    telephone: phone,
    priceRange: '$$',
    openingHours: 'Mo-Su 00:00-23:59', // 24/7 availability
    url: baseUrl,
    hasOfferCatalog: {
      '@type': 'OfferCatalog',
      name: 'Funeral Services',
      itemListElement: [
        {
          '@type': 'Offer',
          itemOffered: {
            '@type': 'Service',
            name: 'Cremation Services',
            description: 'Comprehensive cremation services including direct cremation, memorial services, and full-service options.'
          }
        },
        {
          '@type': 'Offer',
          itemOffered: {
            '@type': 'Service',
            name: 'Burial Services',
            description: 'Traditional burial services with dignity and respect.'
          }
        }
      ]
    }
  };
  
  // Add address if available
  if (Object.keys(address).length > 0) {
    schema.address = address;
  }
  
  // Add service area if coordinates are available (can be added later)
  // schema.serviceArea = {
  //   '@type': 'GeoCircle',
  //   geoMidpoint: {
  //     '@type': 'GeoCoordinates',
  //     latitude: '40.123',
  //     longitude: '-80.456'
  //   }
  // };
  
  return JSON.stringify(schema);
}

const baseSchema = generateBaseSchema();
---

<!doctype html>
<html lang={detectedLanguage}>
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={pageDescription} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Favicons - WebP format for optimal performance -->
    <link rel="icon" type="image/webp" href={faviconConfig.standard} />
    <link rel="icon" type="image/webp" href={faviconConfig.highDpi} sizes="32x32" />
    <link rel="apple-touch-icon" href={faviconConfig.appleTouch} />
    
    <meta name="generator" content={Astro.generator} />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={Astro.url.href} />
    <meta property="og:title" content={pageTitle} />
    <meta property="og:description" content={pageDescription} />
    <meta property="og:image" content={new URL('/images/hero.webp', Astro.site || Astro.url.origin).href} />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={Astro.url.href} />
    <meta name="twitter:title" content={pageTitle} />
    <meta name="twitter:description" content={pageDescription} />
    <meta name="twitter:image" content={new URL('/images/hero.webp', Astro.site || Astro.url.origin).href} />
    
    <!-- Canonical URL -->
    <link rel="canonical" href={Astro.url.href} />
    
    <!-- SEO: hreflang tags for language alternates -->
    {alternateUrls.map((alt) => (
      <link rel="alternate" hreflang={alt.lang} href={alt.url} />
    ))}
    <link rel="alternate" hreflang="x-default" href={alternateUrls.find(a => a.lang === 'en')?.url || alternateUrls[0].url} />
    
    <!-- Structured Data (Schema.org JSON-LD) -->
    <script type="application/ld+json" set:html={baseSchema} />
    
    <!-- Preload hero image for faster LCP -->
    <link rel="preload" as="image" href="/images/hero.webp" imagesrcset="/images/hero-640.webp 640w, /images/hero.webp 970w" imagesizes="(max-width: 640px) 640px, 970px" />
    
    <!-- Google Fonts: Merriweather (headings) + Inter (body) -->
    <!-- Resource hints for faster font loading -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com" />
    <link rel="dns-prefetch" href="https://fonts.gstatic.com" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <!-- Load fonts asynchronously to prevent render-blocking -->
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'" />
    <noscript>
      <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    </noscript>
    
    <title>{pageTitle}</title>
    <!-- Early dark mode detection to prevent flash -->
    <script>
      (function() {
        try {
          function getDarkModePreference() {
            try {
              const saved = localStorage.getItem('darkMode');
              if (saved !== null) {
                return saved === 'true';
              }
              if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return true;
              }
              return false;
            } catch (err) {
              return false;
            }
          }
          
          if (getDarkModePreference()) {
            document.documentElement.classList.add('dark');
          }
        } catch (err) {
          // Silently fail
        }
      })();
    </script>
    <style>
      /* Ensure colors are applied */
      :root {
        --color-primary: #1a3b34;
        --color-primary-dark: #0f2520;
        --color-primary-light: #2d5a4f;
        --color-secondary: #f9f7f2;
        --color-secondary-dark: #e8e6e0;
        --color-accent: #8b6f3f;
        --color-accent-dark: #6d5632;
        --color-background: #f9f7f2;
        --color-text: #2d2d2d;
      }
      
      /* Font display strategy - prevents layout shift during font loading */
      @font-face {
        font-family: 'Merriweather';
        font-display: swap;
      }
      
      @font-face {
        font-family: 'Inter';
        font-display: swap;
      }
      
      /* Dark mode color variables */
      .dark {
        --color-primary: #2d5a4f;
        --color-primary-dark: #1a3b34;
        --color-primary-light: #3d6a5f;
        --color-secondary: #1a1a1a;
        --color-secondary-dark: #2d2d2d;
        --color-accent: #a6895f;
        --color-accent-dark: #8b6f3f;
        --color-background: #0f0f0f;
        --color-text: #e8e8e8;
      }
      
      /* Dark mode styles */
      .dark body {
        background-color: var(--color-background);
        color: var(--color-text);
      }
      
      .dark .bg-primary {
        background-color: var(--color-primary);
      }
      
      .dark .bg-secondary {
        background-color: var(--color-secondary);
      }
      
      .dark .bg-background {
        background-color: var(--color-background);
      }
      
      .dark .text-primary {
        color: var(--color-primary-light);
      }
      
      .dark .text-text {
        color: var(--color-text);
      }
      
      .dark .text-white {
        color: #ffffff;
      }
      
      .dark nav {
        background-color: var(--color-primary-dark);
      }
      
      .dark .bg-secondary {
        background-color: var(--color-secondary);
      }
      
      .dark .hover\:bg-secondary\/80:hover {
        background-color: var(--color-secondary-dark);
      }
      
      .dark .border-gray-200 {
        border-color: #374151;
      }
      
      .dark .hover\:bg-gray-100:hover {
        background-color: var(--color-secondary-dark);
      }
      
      /* Smooth transitions for dark mode */
      * {
        transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      }
      
      /* Exclude certain elements from transition */
      img,
      video,
      canvas,
      audio,
      iframe,
      embed,
      object {
        transition: none;
      }
      
      /* Enhanced link hover effects */
      a:not(.btn):not(.nav-link):not(.footer-link) {
        transition: color 0.2s ease, transform 0.2s ease;
      }
      
      a:not(.btn):not(.nav-link):not(.footer-link):hover {
        transform: translateX(2px);
      }
      
      /* Navigation link hover effects */
      .nav-link:not([aria-current="page"]):hover {
        transform: translateY(-1px);
      }
      
      /* Footer link hover effects */
      .footer-link:hover {
        transform: translateX(4px);
      }
      
      /* SVG icons should have smooth transitions */
      svg {
        transition: transform 0.2s ease, opacity 0.2s ease;
      }
      
      /* Skip to main content link - hidden by default, visible on focus */
      .skip-to-content {
        position: absolute;
        top: -100px;
        left: 0;
        z-index: 100;
        padding: 0.75rem 1.5rem;
        background-color: var(--color-primary);
        color: white;
        text-decoration: none;
        font-weight: 600;
        border-radius: 0 0 0.375rem 0;
        transition: top 0.2s ease;
      }
      
      .skip-to-content:focus {
        top: 0;
        outline: 3px solid var(--color-accent);
        outline-offset: 2px;
      }
      
      /* Prevent horizontal overflow globally */
      html, body {
        overflow-x: hidden;
        max-width: 100%;
        width: 100%;
      }
      
      /* Ensure container doesn't cause overflow */
      .container {
        max-width: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body class="font-body text-text bg-background min-h-screen flex flex-col antialiased relative">
    <!-- Skip to main content link for keyboard navigation -->
    <a 
      href="#main-content" 
      class="skip-to-content"
    >
      {detectedLanguage === 'es' ? 'Saltar al contenido principal' : 'Skip to main content'}
    </a>
    <PageLoadingOverlay />
    <Navbar />
    <Breadcrumb items={breadcrumbItems} />
    <main id="main-content" class="flex-grow">
      <slot />
    </main>
    <Footer pageType={detectedPageType} language={detectedLanguage} />
    <BackToTop />
    
    <!-- Language Detection Script -->
    <script>
      /**
       * Automatic language detection based on browser settings
       * Redirects to appropriate language version on first visit
       * Allows manual override via localStorage
       */
      (function() {
        try {
          // Only run on client-side
          if (typeof window === 'undefined') return;
          
          const currentPath = window.location.pathname;
          const isSpanishPage = currentPath.includes('-es') || currentPath === '/es';
          const currentLang = isSpanishPage ? 'es' : 'en';
          
          // Check if this is the first visit (no language preference saved)
          const hasVisited = localStorage.getItem('hasVisited');
          const savedPreference = localStorage.getItem('preferredLanguage');
          const languageOverride = localStorage.getItem('languageOverride');
          
          // If user has manually selected a language via toggle, don't auto-redirect
          // This allows users to override browser preferences
          if (languageOverride) {
            // Update saved preference to match override
            if (languageOverride !== savedPreference) {
              localStorage.setItem('preferredLanguage', languageOverride);
            }
            // Don't redirect - respect user's manual choice
            return;
          }
          
          // On first visit, detect and redirect if needed
          if (!hasVisited && !savedPreference) {
            // Detect browser language
            const browserLang = navigator.language || (navigator as any).userLanguage || 'en';
            const langCode = browserLang.split('-')[0].toLowerCase();
            let detectedLang: 'en' | 'es' = 'en';
            
            // Check if browser language is Spanish
            if (langCode === 'es') {
              detectedLang = 'es';
            } else if (navigator.languages) {
              // Check all preferred languages
              for (const lang of navigator.languages) {
                if (lang.toLowerCase().startsWith('es')) {
                  detectedLang = 'es';
                  break;
                }
              }
            }
            
            // Only redirect if detected language differs from current page
            if (detectedLang === 'es' && currentLang === 'en' && currentPath === '/') {
              // Redirect to Spanish version
              const routeMap: Record<string, string> = {
                '/': '/es',
                '/catholic': '/catholic-es',
                '/veteran': '/veteran-es',
                '/cremation': '/cremation-es',
                '/burial': '/burial-es',
                '/catholic-cremation': '/catholic-cremation-es',
                '/catholic-burial': '/catholic-burial-es',
                '/veteran-cremation': '/veteran-cremation-es',
                '/veteran-burial': '/veteran-burial-es',
              };
              
              const redirectPath = routeMap[currentPath] || `${currentPath}-es`;
              if (redirectPath !== currentPath) {
                // Save preference to prevent redirect loops
                localStorage.setItem('preferredLanguage', detectedLang);
                localStorage.setItem('hasVisited', 'true');
                window.location.href = redirectPath;
                return;
              }
            } else if (detectedLang === 'en' && currentLang === 'es' && currentPath === '/es') {
              // Redirect to English version if on Spanish home and browser prefers English
              localStorage.setItem('preferredLanguage', 'en');
              localStorage.setItem('hasVisited', 'true');
              window.location.href = '/';
              return;
            }
            
            // Mark as visited
            localStorage.setItem('hasVisited', 'true');
            localStorage.setItem('preferredLanguage', detectedLang);
          } else if (savedPreference && savedPreference !== currentLang) {
            // If user has a saved preference that differs from current page
            // Only redirect on home page to avoid breaking deep links
            if (currentPath === '/' || currentPath === '/es') {
              const redirectPath = savedPreference === 'es' ? '/es' : '/';
              if (redirectPath !== currentPath) {
                window.location.href = redirectPath;
                return;
              }
            }
          }
        } catch (error) {
          // Silently fail - language detection is a non-critical enhancement
        }
      })();
    </script>
    
    <style>
      /* Enhanced focus-visible states for accessibility */
      *:focus-visible {
        outline: 2px solid theme('colors.accent.DEFAULT');
        outline-offset: 2px;
        border-radius: 4px;
      }

      /* Enhanced focus for buttons and links */
      button:focus-visible,
      a:focus-visible {
        outline: 3px solid theme('colors.accent.DEFAULT');
        outline-offset: 3px;
      }

      /* Enhanced focus for form inputs */
      input:focus-visible,
      textarea:focus-visible,
      select:focus-visible {
        outline: 2px solid theme('colors.accent.DEFAULT');
        outline-offset: 2px;
        border-color: theme('colors.accent.DEFAULT');
      }

      /* Remove default outline for mouse users (not keyboard) */
      *:focus:not(:focus-visible) {
        outline: none;
      }

      /* Standardized Button Styles */
      .btn {
        display: inline-block;
        padding: 0.75rem 1.5rem;
        border-radius: 0.375rem;
        font-weight: 600;
        text-align: center;
        text-decoration: none;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        border: none;
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        position: relative;
        overflow: hidden;
      }

      /* Allow flex to override display for buttons that need it */
      .btn.flex {
        display: flex;
      }

      .btn:disabled {
        opacity: 0.7;
        cursor: not-allowed;
      }

      /* Button hover effects */
      .btn:not(:disabled):hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      .btn:not(:disabled):active {
        transform: translateY(0);
        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      }

      /* Button Variants */
      .btn-primary {
        background-color: var(--color-primary);
        color: white;
      }

      .btn-primary:hover:not(:disabled) {
        background-color: var(--color-primary-dark);
      }

      .btn-accent {
        background-color: var(--color-accent);
        color: white;
      }

      .btn-accent:hover:not(:disabled) {
        background-color: var(--color-accent-dark);
      }

      .btn-secondary {
        background-color: var(--color-secondary);
        color: var(--color-primary);
      }

      .btn-secondary:hover:not(:disabled) {
        background-color: var(--color-secondary-dark);
      }

      /* Button Sizes */
      .btn-sm {
        padding: 0.5rem 1rem;
        font-size: 0.875rem;
      }

      .btn-md {
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
      }

      .btn-lg {
        padding: 1rem 2rem;
        font-size: 1.125rem;
      }

      /* Full Width Button */
      .btn-full {
        width: 100%;
      }

      /* Comprehensive Print Styles */
      @media print {
        /* Hide non-essential elements */
        nav,
        footer,
        .breadcrumb-container,
        .back-to-top,
        .no-print,
        button,
        .btn,
        form,
        .contact-form,
        .service-nav,
        .service-buttons,
        .service-tabs {
          display: none !important;
        }

        /* Skip to main content link */
        a[href="#main-content"] {
          display: none !important;
        }

        /* Optimize page setup */
        @page {
          margin: 1in;
          size: letter;
        }

        /* Optimize typography for print */
        body {
          font-size: 12pt;
          line-height: 1.6;
          color: #000 !important;
          background: #fff !important;
          font-family: 'Inter', Arial, sans-serif;
        }

        /* Headings */
        h1, h2, h3, h4, h5, h6 {
          color: #000 !important;
          font-family: 'Merriweather', Georgia, serif;
          page-break-after: avoid;
          page-break-inside: avoid;
          margin-top: 1.5em;
          margin-bottom: 0.75em;
        }

        h1 {
          font-size: 24pt;
          border-bottom: 2px solid #000;
          padding-bottom: 0.5em;
        }

        h2 {
          font-size: 18pt;
          margin-top: 1.25em;
        }

        h3 {
          font-size: 14pt;
        }

        /* Paragraphs and text */
        p {
          margin-bottom: 1em;
          orphans: 3;
          widows: 3;
        }

        /* Lists */
        ul, ol {
          margin-bottom: 1em;
          padding-left: 1.5em;
        }

        li {
          margin-bottom: 0.5em;
          page-break-inside: avoid;
        }

        /* Links */
        a {
          color: #000 !important;
          text-decoration: underline;
        }

        a[href^="http"]:after {
          content: " (" attr(href) ")";
          font-size: 10pt;
          color: #666;
        }

        a[href^="#"]:after,
        a[href^="/"]:after {
          content: "";
        }

        /* Images */
        img {
          max-width: 100% !important;
          height: auto !important;
          page-break-inside: avoid;
          page-break-after: avoid;
        }

        /* Hero images - hide or show as needed */
        .hero-section img,
        section[class*="hero"] img {
          max-height: 3in;
          object-fit: cover;
        }

        /* Sections */
        section {
          page-break-inside: avoid;
          margin-bottom: 1.5em;
        }

        /* Containers */
        .container {
          max-width: 100% !important;
          padding: 0 !important;
        }

        /* Remove backgrounds and borders */
        * {
          background: transparent !important;
          box-shadow: none !important;
          text-shadow: none !important;
        }

        /* Tables */
        table {
          border-collapse: collapse;
          width: 100%;
          page-break-inside: avoid;
        }

        th, td {
          border: 1px solid #000;
          padding: 0.5em;
        }

        th {
          background: #f0f0f0 !important;
          font-weight: bold;
        }

        /* Accordion - show all content */
        details {
          display: block !important;
        }

        details summary {
          display: list-item !important;
          font-weight: bold;
          margin-bottom: 0.5em;
        }

        details[open] summary {
          margin-bottom: 0.5em;
        }

        /* Code blocks */
        pre, code {
          background: #f5f5f5 !important;
          border: 1px solid #ccc;
          page-break-inside: avoid;
        }

        /* Page breaks */
        .page-break-before {
          page-break-before: always;
        }

        .page-break-after {
          page-break-after: always;
        }

        .page-break-avoid {
          page-break-inside: avoid;
        }

        /* Ensure content doesn't break awkwardly */
        blockquote {
          border-left: 4px solid #000;
          padding-left: 1em;
          margin: 1em 0;
          page-break-inside: avoid;
        }

        /* Remove spacing that's not needed in print */
        .py-8, .py-10, .py-12, .py-16, .py-24, .py-32 {
          padding-top: 0.5em !important;
          padding-bottom: 0.5em !important;
        }

        .px-4, .px-6, .px-8 {
          padding-left: 0 !important;
          padding-right: 0 !important;
        }

        /* Ensure proper spacing at end of document */
        main {
          padding-bottom: 1em;
        }
      }
    </style>
  </body>
</html>

